# ğŸ“˜ 5.3 ì ì¬ì ì¸ í•« ì½”ë“œ ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ” ë‹¨ì–´ ì„œë¹„ìŠ¤

## 5.3.0 ê°œìš”

* ë‘ ê°œì˜ ê¸°ëŠ¥ì„ ê°€ì§„ **ë‹¨ì–´ ì„œë¹„ìŠ¤(Word Service)** êµ¬ì¶• ì˜ˆì‹œ

    1. **ì˜¤ëŠ˜ì˜ ë‹¨ì–´ ì œê³µ (word-of-the-day)**
    2. **ë‹¨ì–´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ (word-exists)**

ì„œë¹„ìŠ¤ëŠ” `WordsService` ì¸í„°í˜ì´ìŠ¤ë¡œ ì •ì˜ë˜ë©°, API ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ì™¸ë¶€ì— ë…¸ì¶œëœë‹¤.

---

## 5.3.1 ì˜¤ëŠ˜ì˜ ë‹¨ì–´ ì–»ê¸°

* **í•µì‹¬ ì•„ì´ë””ì–´**: ì˜¤ëŠ˜ ë‚ ì§œ(LocalDate)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¸ë±ìŠ¤ë¥¼ ê³„ì‚° â†’ ì‚¬ì „ íŒŒì¼ì—ì„œ ë‹¨ì–´ ë°˜í™˜

* ì¸ë±ìŠ¤ ê³„ì‚°ì‹:

  ```
  now.getYear() + now.getDayOfYear() * MULTIPLY_FACTOR
  ```

    * `MULTIPLY_FACTOR = 100` (ì„ì˜ì˜ ìˆ˜ ê°€ëŠ¥)
    * ë‹¨ìˆœíˆ `LocalDate.now()`ë§Œ ì“°ì§€ ì•Šê³ , í…ŒìŠ¤íŠ¸ ìš©ì´ì„±ì„ ìœ„í•´ **ê³µê¸‰ì í•¨ìˆ˜(IntSupplier)** ë¡œ ë¶„ë¦¬

* êµ¬í˜„ ë¡œì§:

    * `Scanner`ë¥¼ ì´ìš©í•´ ì‚¬ì „ íŒŒì¼ì„ í•œ ì¤„ì”© ì½ëŠ”ë‹¤.
    * ê¸°ëŒ€í•˜ëŠ” ì¸ë±ìŠ¤ ìœ„ì¹˜ì— ë„ë‹¬í•˜ë©´ ë‹¨ì–´ ë°˜í™˜.
    * ì¸ë±ìŠ¤ê°€ íŒŒì¼ ë²”ìœ„ë¥¼ ì´ˆê³¼í•˜ë©´ `"No word today."` ë°˜í™˜.

ğŸ“Œ **ì €ì˜ ìƒê°**
â†’ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±ê³¼ ë‹¨ìˆœì„±ì„ ê³ ë ¤í•œ ì„¤ê³„. ì‹¤ì œ ëŒ€ìš©ëŸ‰ í™˜ê²½ì—ì„œëŠ” íŒŒì¼ ì „ì²´ ìˆœíšŒ ë°©ì‹ì€ ë³‘ëª©ì´ ë  ìˆ˜ ìˆì–´ ìºì‹±ì´ë‚˜ ì¸ë±ìŠ¤í™”ê°€ í•„ìš”í•  ê²ƒ ê°™ìŒ.

---

## 5.3.2 ë‹¨ì–´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸

* `wordExists(String word)` ë©”ì„œë“œ

    * íŒŒì¼ ì „ì²´ë¥¼ ìˆœíšŒí•˜ë©´ì„œ ë‹¨ì–´ë¥¼ ê²€ìƒ‰.
    * ë°œê²¬ ì‹œ `true`, ëê¹Œì§€ ì—†ìœ¼ë©´ `false`.
    * í˜„ì¬ëŠ” SLA, ì„±ëŠ¥ ìµœì í™” ê³ ë ¤ X.

ğŸ“Œ **ì €ì˜ ìƒê°**
â†’ ì´ˆë°˜ ë‹¨ê³„ì—ì„œ â€œì„±ê¸‰í•œ ìµœì í™”ëŠ” ê¸ˆë¬¼â€ì´ë¼ëŠ” ì² í•™ì´ ì˜ ë°˜ì˜ë¨. ì‹¤ì œ íŠ¸ë˜í”½/ìš”êµ¬ì‚¬í•­ì„ ëª¨ë‹ˆí„°ë§í•œ í›„ ìµœì í™”í•´ì•¼ í•¨.

---

## 5.3.3 HTTP ì„œë¹„ìŠ¤ ê³µê°œ

* `WordsController`ë¥¼ í†µí•´ ë‘ ê¸°ëŠ¥ì„ HTTP ì—”ë“œí¬ì¸íŠ¸ë¡œ ë…¸ì¶œ:

    * `/words/word-of-the-day` â†’ ì˜¤ëŠ˜ì˜ ë‹¨ì–´
    * `/words/word-exists?word=xxx` â†’ ë‹¨ì–´ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
* Dropwizard HTTP ì„œë²„ë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬ë™.

ğŸ“Œ **ì €ì˜ ìƒê°**
â†’ API ì„¤ê³„ì˜ ê¸°ë³¸ê¸°ë¥¼ ì˜ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œ. í•˜ì§€ë§Œ `word-exists` ì—”ë“œí¬ì¸íŠ¸ëŠ” ì‚¬ìš© ë¹ˆë„ê°€ í›¨ì”¬ ë†’ì„ ê°€ëŠ¥ì„±ì´ ì»¤ì„œ ì ì¬ì  **í•« ì½”ë“œ ê²½ë¡œ(hot path)** í›„ë³´ì„.

---

## 5.3.x ì„±ëŠ¥ ê´€ì°° ë° í–¥í›„ ìµœì í™” ê³ ë ¤

* ì˜ˆìƒ íŠ¸ë˜í”½:

    * `/word-of-the-day` : ì´ˆë‹¹ 1íšŒ
    * `/word-exists` : ì´ˆë‹¹ 20íšŒ
* ì¦‰, `word-exists`ê°€ ì „ì²´ ìš”ì²­ì˜ ì•½ **95%** ì°¨ì§€ â†’ íŒŒë ˆí†  ë²•ì¹™ì— ë¶€í•©.
* ë”°ë¼ì„œ **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ (ì˜ˆ: Gatling)** ë¥¼ í†µí•´ ì‹¤ì œ ëŒ€ê¸° ì‹œê°„ ë° ìµœì í™” í•„ìš”ì„± í‰ê°€.

---

# ğŸ“ ìš”ì•½ (í•œ ì¤„ ì••ì¶•)

> 5.3 ì ˆì€ â€œì„±ê¸‰í•œ ìµœì í™”ë³´ë‹¤ ì‹¤ì œ íŠ¸ë˜í”½ ê¸°ë°˜ì˜ **í•« ì½”ë“œ ê²½ë¡œ ìµœì í™”**â€ì˜ ì¤‘ìš”ì„±ì„ ë‹¨ì–´ ì„œë¹„ìŠ¤ ì˜ˆì œë¡œ ë³´ì—¬ì¤€ë‹¤.

---

# ğŸ’» Kotlin ì˜ˆì œ ì½”ë“œ (as-is / to-be)

## As-Is (ë‹¨ìˆœ êµ¬í˜„)

```kotlin
class WordService(private val dictionaryPath: Path) {
    private val multiplyFactor = 100

    fun getWordOfTheDay(): String {
        val index = getIndexForToday()
        Files.newBufferedReader(dictionaryPath).use { reader ->
            reader.lineSequence().forEachIndexed { i, line ->
                if (i == index) return line
            }
        }
        return "No word today."
    }

    fun wordExists(word: String): Boolean {
        Files.newBufferedReader(dictionaryPath).use { reader ->
            reader.lineSequence().forEach { line ->
                if (line == word) return true
            }
        }
        return false
    }

    private fun getIndexForToday(): Int {
        val now = LocalDate.now()
        return now.year + now.dayOfYear * multiplyFactor
    }
}
```

## To-Be (í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„± + ìµœì í™” ê³ ë ¤)

```kotlin
class WordServiceV2(
    private val dictionaryPath: Path,
    private val indexProvider: () -> Int = { defaultIndex() }
) {
    companion object {
        private const val MULTIPLY_FACTOR = 100
        fun defaultIndex(): Int {
            val now = LocalDate.now()
            return now.year + now.dayOfYear * MULTIPLY_FACTOR
        }
    }

    // ì˜¤ëŠ˜ì˜ ë‹¨ì–´ (ìºì‹± ì¶”ê°€ ê°€ëŠ¥)
    fun getWordOfTheDay(): String {
        val index = indexProvider()
        return Files.newBufferedReader(dictionaryPath).use { reader ->
            reader.lineSequence().elementAtOrNull(index) ?: "No word today."
        }
    }

    // ë‹¨ì–´ ì¡´ì¬ ì—¬ë¶€ (í–¥í›„ ì¸ë©”ëª¨ë¦¬ Setìœ¼ë¡œ ìµœì í™” ê°€ëŠ¥)
    fun wordExists(word: String): Boolean {
        return Files.newBufferedReader(dictionaryPath).use { reader ->
            reader.lineSequence().any { it == word }
        }
    }
}
```

---

# âœ… Kotest í…ŒìŠ¤íŠ¸ ì˜ˆì œ

```kotlin
class WordServiceTest : StringSpec({
    val testFile = Files.createTempFile("words", ".txt").apply {
        Files.write(this, listOf("apple", "banana", "cherry"))
    }

    "ì˜¤ëŠ˜ì˜ ë‹¨ì–´ê°€ ì˜¬ë°”ë¥¸ ì¸ë±ìŠ¤ë¡œ ë°˜í™˜ëœë‹¤" {
        val service = WordServiceV2(testFile) { 1 } // banana ì¸ë±ìŠ¤ ê°•ì œ
        service.getWordOfTheDay() shouldBe "banana"
    }

    "ë‹¨ì–´ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° trueë¥¼ ë°˜í™˜í•œë‹¤" {
        val service = WordServiceV2(testFile)
        service.wordExists("cherry") shouldBe true
    }

    "ë‹¨ì–´ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš° falseë¥¼ ë°˜í™˜í•œë‹¤" {
        val service = WordServiceV2(testFile)
        service.wordExists("durian") shouldBe false
    }
})
```

---

# ğŸŒ ì°¸ê³  ìë£Œ

* [Dropwizard Framework](https://www.dropwizard.io) â†’ ê²½ëŸ‰ ì›¹ ì„œë¹„ìŠ¤ êµ¬ì¶•ìš©
* [Gatling](https://gatling.io/open-source/) â†’ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ë„êµ¬
* [íŒŒë ˆí†  ë²•ì¹™(80/20 Rule)](https://en.wikipedia.org/wiki/Pareto_principle)

---

