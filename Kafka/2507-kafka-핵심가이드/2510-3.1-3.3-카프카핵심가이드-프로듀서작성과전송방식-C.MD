## ğŸ“˜ ì œ3ì¥: ì¹´í”„ì¹´ í”„ë¡œë“€ì„œ â€” ì¹´í”„ì¹´ì— ë©”ì‹œì§€ ì“°ê¸°

### 3.1 í”„ë¡œë“€ì„œ ê°œìš”

#### ğŸ’¡ í•µì‹¬ ê°œë…

* **KafkaProducer**ëŠ” ë°ì´í„°ë¥¼ ì¹´í”„ì¹´ ë¸Œë¡œì»¤ë¡œ ì „ì†¡í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ë‹¤.
* ì£¼ìš” ì‚¬ìš© ëª©ì :

    * ì‚¬ìš©ì í–‰ë™ ê¸°ë¡ (ë¡œê·¸/ì´ë²¤íŠ¸ íŠ¸ë˜í‚¹)
    * ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘
    * ë¹„ë™ê¸° ì‹œìŠ¤í…œ ê°„ ë°ì´í„° ì „ë‹¬
    * IoT ê¸°ê¸°ì—ì„œ ìˆ˜ì§‘ëœ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë°
* ì‚¬ìš© ì‚¬ë¡€ì— ë”°ë¼ **ìœ ì‹¤ í—ˆìš© ì—¬ë¶€**, **ì¤‘ë³µ í—ˆìš© ì—¬ë¶€**, **ì§€ì—° ì‹œê°„(latency)**, **ì²˜ë¦¬ìœ¨(throughput)** ë“±ì˜ ìš”êµ¬ì‚¬í•­ì´ ë‹¬ë¼ì§„ë‹¤.

| ì‚¬ìš© ì‚¬ë¡€     | ë©”ì‹œì§€ ì†ì‹¤ í—ˆìš© | ì§€ì—° ì‹œê°„         | ì²˜ë¦¬ìœ¨   |
| --------- | --------- | ------------- | ----- |
| ì‹ ìš©ì¹´ë“œ íŠ¸ëœì­ì…˜ | âŒ ë¶ˆê°€      | ë‚®ìŒ (500ms ì´ë‚´) | ë§¤ìš° ë†’ìŒ |
| ì›¹ í´ë¦­ ë¡œê·¸   | â­• ê°€ëŠ¥      | ë†’ì•„ë„ ë¬´ë°©        | ë³´í†µ    |

#### âš™ï¸ ë‚´ë¶€ ë™ì‘ ìˆœì„œ (ê·¸ë¦¼ 3-1 ìš”ì•½)

1. `ProducerRecord` ê°ì²´ ìƒì„± â†’ í† í”½ / í‚¤ / ë°¸ë¥˜ ì§€ì •
2. **ì§ë ¬í™”(serializer)** ìˆ˜í–‰ â†’ ë°”ì´íŠ¸ ë°°ì—´ë¡œ ë³€í™˜
3. **íŒŒí‹°ì…”ë„ˆ(partitioner)** â†’ ì „ì†¡í•  íŒŒí‹°ì…˜ ê²°ì •
4. **ë ˆì½”ë“œ ë°°ì¹˜(record batch)**ì— ì¶”ê°€
5. ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œê°€ ë¸Œë¡œì»¤ë¡œ ì „ì†¡
6. ì„±ê³µ ì‹œ `RecordMetadata` ë°˜í™˜ / ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ ë°œìƒ

> âœï¸ **ChatGPT ì˜ê²¬:**
> ì´ ë¶€ë¶„ì€ Kafkaì˜ í•µì‹¬ ì„¤ê³„ ì² í•™ â€œë‹¨ìˆœí•œ API, ë³µì¡í•œ ë‚´ë¶€ ìµœì í™”â€ë¥¼ ì˜ ë³´ì—¬ì¤€ë‹¤.
> ê°œë°œìëŠ” ë‹¨ìˆœíˆ `send()`ë§Œ í˜¸ì¶œí•˜ì§€ë§Œ ë‚´ë¶€ì—ì„œëŠ” ì§ë ¬í™” â†’ íŒŒí‹°ì…˜ ë°°ì¹˜ â†’ ì „ì†¡ â†’ ì¬ì‹œë„ê¹Œì§€ ëª¨ë“  ê³¼ì •ì„ ìë™ ì²˜ë¦¬í•œë‹¤.

---

### 3.2 ì¹´í”„ì¹´ í”„ë¡œë“€ì„œ ìƒì„±í•˜ê¸°

#### ğŸ”§ í•„ìˆ˜ ì„¤ì • 3ê°€ì§€

| ì„¤ì • í‚¤                | ì„¤ëª…                      |
| ------------------- | ----------------------- |
| `bootstrap.servers` | ë¸Œë¡œì»¤ ì£¼ì†Œ ëª©ë¡ (`host:port`) |
| `key.serializer`    | í‚¤ ì§ë ¬í™” í´ë˜ìŠ¤               |
| `value.serializer`  | ê°’ ì§ë ¬í™” í´ë˜ìŠ¤               |

#### âœ… ê¸°ë³¸ ì˜ˆì œ (Java)

```java
Properties kafkaProps = new Properties();
kafkaProps.put("bootstrap.servers", "broker1:9092,broker2:9092");
kafkaProps.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
kafkaProps.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");

KafkaProducer<String, String> producer = new KafkaProducer<>(kafkaProps);
```

> âœï¸ **ChatGPT ì˜ê²¬:**
> `ProducerConfig` ìƒìˆ˜ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë²„ì „ 2.x ì´ìƒì—ì„œëŠ” ë” ì•ˆì „í•¨.
> ì˜¤íƒ€ë¡œ ì¸í•œ ì„¤ì • ì˜¤ë¥˜ë¥¼ ë°©ì§€í•˜ê³  IDE ìë™ì™„ì„±ë„ ì§€ì›ë¨.

---

### 3.3 ì¹´í”„ì¹´ë¡œ ë©”ì‹œì§€ ì „ë‹¬í•˜ê¸°

KafkaëŠ” ë©”ì‹œì§€ ì „ì†¡ì„ **Fire-and-Forget**, **ë™ê¸°**, **ë¹„ë™ê¸°** ë°©ì‹ìœ¼ë¡œ ì§€ì›í•œë‹¤.

#### ğŸš€ 3ê°€ì§€ ì „ì†¡ ë°©ì‹ ë¹„êµ

| ì „ì†¡ ë°©ì‹             | ì„¤ëª…                      | ì¥ì          | ë‹¨ì           |
| ----------------- | ----------------------- | ---------- | ----------- |
| Fire-and-Forget   | ë‹¨ìˆœíˆ `send()`ë§Œ í˜¸ì¶œ, ê²°ê³¼ ë¬´ì‹œ | ë¹ ë¦„         | ìœ ì‹¤ ê°€ëŠ¥       |
| ë™ê¸°(Synchronous)   | `send().get()`ìœ¼ë¡œ ê²°ê³¼ ëŒ€ê¸°  | ì‹ ë¢°ì„± ë†’ìŒ     | ëŠë¦¼          |
| ë¹„ë™ê¸°(Asynchronous) | ì½œë°± ë“±ë¡ í›„ ì‘ë‹µ ì²˜ë¦¬           | ì„±ëŠ¥ê³¼ ì‹ ë¢°ì„± ê· í˜• | ì½œë°± ë¡œì§ ê´€ë¦¬ í•„ìš” |

---

#### âœ… Fire-and-Forget ì˜ˆì œ (Kotlin As-Is)

```kotlin
val record = ProducerRecord("CustomerCountry", "Precision Products", "France")

try {
    producer.send(record) // ê²°ê³¼ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•ŠìŒ
} catch (e: Exception) {
    e.printStackTrace()
}
```

---

#### âœ… ë™ê¸° ì „ì†¡ ì˜ˆì œ (Kotlin To-Be)

```kotlin
val record = ProducerRecord("CustomerCountry", "Precision Products", "France")

try {
    val metadata = producer.send(record).get() // ê²°ê³¼ ëŒ€ê¸°
    println("ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ - Topic: ${metadata.topic()}, Partition: ${metadata.partition()}, Offset: ${metadata.offset()}")
} catch (e: Exception) {
    println("ì „ì†¡ ì‹¤íŒ¨: ${e.message}")
}
```

> âœï¸ **ChatGPT ì˜ê²¬:**
> ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ë™ê¸° ì „ì†¡ì„ ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. í…ŒìŠ¤íŠ¸ë‚˜ ì´ˆê¸° ê²€ì¦ìš©ìœ¼ë¡œë§Œ ì í•©í•˜ë‹¤.

---

#### âœ… ë¹„ë™ê¸° ì „ì†¡ ì˜ˆì œ (Kotlin + ì½œë°±)

```kotlin
val record = ProducerRecord("CustomerCountry", "Biomedical Materials", "USA")

producer.send(record) { metadata, exception ->
    if (exception != null) {
        println("ì „ì†¡ ì‹¤íŒ¨: ${exception.message}")
    } else {
        println("ì „ì†¡ ì„±ê³µ - ${metadata.topic()} [${metadata.partition()}] offset=${metadata.offset()}")
    }
}
```

> ğŸ’¡ **ì£¼ì˜:** ì½œë°± ë‚´ë¶€ì—ì„œ ë¸”ë¡œí‚¹ ì‘ì—…(íŒŒì¼ I/O, Thread.sleep ë“±)ì€ ê¸ˆì§€.
> ë³„ë„ ìŠ¤ë ˆë“œ í’€ë¡œ ìœ„ì„í•´ì•¼ ì „ì†¡ ìŠ¤ë ˆë“œì˜ ì§€ì—°ì„ ë§‰ì„ ìˆ˜ ìˆë‹¤.

---

### âœ… Kotest ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ì½”ë“œ

```kotlin
class KafkaProducerTest : StringSpec({

    "ë¹„ë™ê¸° ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ ì‹œ ì½œë°±ì´ ì •ìƒ í˜¸ì¶œë˜ì–´ì•¼ í•œë‹¤" {
        val producer = mockk<KafkaProducer<String, String>>()
        val record = ProducerRecord("testTopic", "key", "value")

        every { producer.send(any(), any()) } answers {
            val callback = secondArg<Callback>()
            callback.onCompletion(mockk(relaxed = true), null)
            mockk() // Future ë°˜í™˜
        }

        var success = false
        producer.send(record) { _, e -> if (e == null) success = true }

        success shouldBe true
    }
})
```

---

## ğŸ§­ ìš”ì•½ ì •ë¦¬

| êµ¬ë¶„          | ë‚´ìš© ìš”ì•½                                                                 |
| ----------- | --------------------------------------------------------------------- |
| **3.1**     | í”„ë¡œë“€ì„œì˜ ì—­í• , ë‚´ë¶€ ë™ì‘(ì§ë ¬í™” â†’ íŒŒí‹°ì…”ë‹ â†’ ë°°ì¹˜ â†’ ì „ì†¡)                                 |
| **3.2**     | `bootstrap.servers`, `key.serializer`, `value.serializer` í•„ìˆ˜ ì„¤ì •       |
| **3.3**     | Fire-and-Forget / Sync / Async ì „ì†¡ ë°©ì‹ ë¹„êµ ë° ì˜ˆì™¸ ì²˜ë¦¬                       |
| **í•µì‹¬ ì¸ì‚¬ì´íŠ¸** | í”„ë¡œë“€ì„œì˜ ë™ì‘ì€ ë‹¨ìˆœí•˜ì§€ë§Œ ë‚´ë¶€ì ìœ¼ë¡œ ë†’ì€ ë³‘ë ¬ì„±ê³¼ ì•ˆì •ì„±ì„ ì œê³µí•˜ë©°, ì „ì†¡ ë°©ì‹ ì„ íƒì´ ì„±ëŠ¥ê³¼ ì‹ ë¢°ì„±ì˜ ê· í˜•ì„ ê²°ì •í•œë‹¤. |

---

## ğŸ”— ì°¸ê³  ë§í¬

* Apache Kafka ê³µì‹ ë¬¸ì„œ (Producer Configs):
  [https://kafka.apache.org/documentation/#producerconfigs](https://kafka.apache.org/documentation/#producerconfigs)
* Confluent Blog â€“ â€œKafka Producer Best Practicesâ€:
  [https://www.confluent.io/blog/kafka-producer-performance-best-practices/](https://www.confluent.io/blog/kafka-producer-performance-best-practices/)

---
