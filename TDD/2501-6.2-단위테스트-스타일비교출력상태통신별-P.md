## 6.2 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ë¹„êµ

ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” **ì¶œë ¥ ê¸°ë°˜**, **ìƒíƒœ ê¸°ë°˜**, **í†µì‹  ê¸°ë°˜** ìŠ¤íƒ€ì¼ë¡œ ë‚˜ë‰œë‹¤. ì´ ì¥ì—ì„œëŠ” ì´ ì„¸ ê°€ì§€ ìŠ¤íƒ€ì¼ì„ ì¢‹ì€ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ë„¤ ê°€ì§€ ìš”ì†Œ(íšŒê·€ ë°©ì§€, ë¦¬íŒ©í„°ë§ ë‚´ì„±, ë¹ ë¥¸ í”¼ë“œë°±, ìœ ì§€ ë³´ìˆ˜ì„±)ì— ë”°ë¼ ë¹„êµí•œë‹¤.

## 6.2.1 íšŒê·€ ë°©ì§€ / ë¹ ë¥¸ í”¼ë“œë°±ìœ¼ë¡œ ë¹„êµ (p.188â€“189)

### íšŒê·€ ë°©ì§€
- íšŒê·€ ë°©ì§€ëŠ” ì‹¤í–‰ ì½”ë“œì˜ ì–‘, ì½”ë“œ ë³µì¡ë„, ë„ë©”ì¸ ìœ ì˜ì„±ì— ë”°ë¼ ê²°ì •ëœë‹¤.
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ìì²´ê°€ íšŒê·€ ë°©ì§€ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì€ í¬ì§€ ì•Šë‹¤.
- ìœ ì¼í•œ ì˜ˆì™¸ëŠ” **í†µì‹  ê¸°ë°˜ ìŠ¤íƒ€ì¼**ë¡œ, ê³¼ë„í•˜ê²Œ ëª©(mock)ì„ ì‚¬ìš©í•˜ë©´ í…ŒìŠ¤íŠ¸ê°€ í”¼ìƒì ìœ¼ë¡œ ë  ìˆ˜ ìˆë‹¤.

### í”¼ë“œë°± ì†ë„
- **ìŠ¤íƒ€ì¼ ê°„ ì°¨ì´ëŠ” ê±°ì˜ ì—†ë‹¤.**
- ë‹¤ë§Œ, **í†µì‹  ê¸°ë°˜ í…ŒìŠ¤íŠ¸**ì—ì„œëŠ” ëª© ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ì†Œí­ì˜ ì‹¤í–‰ ì§€ì—°ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤(ìˆ˜ ë§Œ ê±´ì´ ì•„ë‹ˆë¼ë©´ í¬ê²Œ ë¬¸ì œë˜ì§€ ì•ŠìŒ).

## 6.2.2 ë¦¬íŒ©í„°ë§ ë‚´ì„± ë¹„êµ (p.189â€“190)

ë¦¬íŒ©í„°ë§ ë‚´ì„±ì€ ë¦¬íŒ©í„°ë§ ì‹œ **ê±°ì§“ ì–‘ì„±(false positive)** ë°œìƒ ê°€ëŠ¥ì„±ê³¼ ê´€ë ¨ëœë‹¤.

| í…ŒìŠ¤íŠ¸ ìŠ¤íƒ€ì¼  | ë¦¬íŒ©í„°ë§ ë‚´ì„± í‰ê°€ | ì´ìœ  |
|----------------|-------------------|------|
| ì¶œë ¥ ê¸°ë°˜      | **ì¢‹ìŒ**           | ëŒ€ìƒ ë©”ì„œë“œì—ë§Œ ê²°í•©ë¨ |
| ìƒíƒœ ê¸°ë°˜      | **ë³´í†µ**           | í´ë˜ìŠ¤ ìƒíƒœì™€ ê²°í•©, API ì˜ì¡´ì„± ë†’ìŒ |
| í†µì‹  ê¸°ë°˜      | **ë‚˜ì¨**           | ëª© ìƒí˜¸ì‘ìš©ì— ì˜ì¡´, ìŠ¤í… ê¹¨ì§€ê¸° ì‰¬ì›€ |

- **ì¶œë ¥ ê¸°ë°˜ í…ŒìŠ¤íŠ¸**: êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ê³¼ ê²°í•©í•˜ì§€ ì•Šì•„ ê°€ì¥ ì•ˆì „.
- **ìƒíƒœ ê¸°ë°˜ í…ŒìŠ¤íŠ¸**: ìƒíƒœ ì˜ì¡´ìœ¼ë¡œ ì¸í•´ ë¦¬íŒ©í„°ë§ ë³€ê²½ ì‹œ ê¹¨ì§ˆ í™•ë¥ ì´ ë†’ìŒ.
- **í†µì‹  ê¸°ë°˜ í…ŒìŠ¤íŠ¸**: ëª© ì²´ì¸, ìŠ¤í… ì„¤ì • ë“±ìœ¼ë¡œ ì¸í•´ ë¯¼ê°ë„ ë†’ìŒ.

## 6.2.3 ìœ ì§€ ë³´ìˆ˜ì„± ë¹„êµ (p.190â€“193)

| í…ŒìŠ¤íŠ¸ ìŠ¤íƒ€ì¼   | ìœ ì§€ë³´ìˆ˜ì„± í‰ê°€ | ì´ìœ  |
|----------------|----------------|------|
| ì¶œë ¥ ê¸°ë°˜       | **ì¢‹ìŒ**         | í…ŒìŠ¤íŠ¸ê°€ ì§§ê³  ì´í•´ ì‰¬ì›€. ì™¸ë¶€ ì˜ì¡´ì„± ì—†ìŒ |
| ìƒíƒœ ê¸°ë°˜       | **ë³´í†µ**         | ìƒíƒœ í™•ì¸ ì½”ë“œê°€ ì¥í™©, í—¬í¼ ì—†ì´ ë³µì¡í•´ì§ |
| í†µì‹  ê¸°ë°˜       | **ë‚˜ì¨**         | ëª© ì„¤ì •ì´ ë³µì¡. ì„¤ì • ì½”ë“œ ë§ìŒ, ì˜¤ë¥˜ ë°œìƒ ê°€ëŠ¥ì„± ì¦ê°€ |

### ì˜ˆì œ ì½”ë“œ ë¹„êµ

#### As-Is: ìƒíƒœ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ â€“ ì¥í™©í•œ ê²€ì¦ ì½”ë“œ
```kotlin
class ArticleTest {

    @Test
    fun `ìƒˆ ëŒ“ê¸€ì´ ì¶”ê°€ë˜ë©´ ìƒíƒœê°€ ë³€ê²½ëœë‹¤`() {
        val sut = Article()
        val text = "Comment text"
        val author = "John Doe"
        val now = LocalDate.of(2024, 1, 1)

        sut.addComment(text, author, now)

        val comment = sut.comments.first()
        comment.text shouldBe text
        comment.author shouldBe author
        comment.dateCreated shouldBe now
    }
}
```

#### To-Be: ì¶œë ¥ ê¸°ë°˜ ë°©ì‹ìœ¼ë¡œ ë³€í™˜ (ê°’ ê°ì²´ ì‚¬ìš©)
```kotlin
data class Comment(val text: String, val author: String, val dateCreated: LocalDate)

class Article {
    private val _comments = mutableListOf()
    val comments: List get() = _comments.toList()

    fun addComment(text: String, author: String, date: LocalDate) {
        _comments.add(Comment(text, author, date))
    }
}

class ArticleTest : StringSpec({
    "ëŒ“ê¸€ì„ ì¶”ê°€í•˜ë©´ ëŒ“ê¸€ ì»¬ë ‰ì…˜ì— ë™ì¼í•œ ëŒ“ê¸€ì´ ì¡´ì¬í•´ì•¼ í•œë‹¤" {
        val sut = Article()
        val comment = Comment("Comment text", "John Doe", LocalDate.of(2024, 1, 1))

        sut.addComment(comment.text, comment.author, comment.dateCreated)

        sut.comments shouldContainExactly listOf(comment)
    }
})
```

â†’ ì¶œë ¥ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ `Comment`ë¥¼ ê°’ ê°ì²´ë¡œ ë§Œë“¤ê³ , ì „ì²´ë¥¼ ë¹„êµí•˜ëŠ” Fluent Assertionì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ê°„ê²°í•˜ê²Œ êµ¬ì„±í•¨

## 6.2.4 ìŠ¤íƒ€ì¼ ë¹„êµ ê²°ë¡  (p.193â€“194)

| ë¹„êµ í•­ëª©                     | ì¶œë ¥ ê¸°ë°˜ | ìƒíƒœ ê¸°ë°˜ | í†µì‹  ê¸°ë°˜ |
|-----------------------------|----------|----------|----------|
| ë¦¬íŒ©í„°ë§ ë‚´ì„± ìœ ì§€ ë…¸ë ¥       | ë‚®ìŒ     | ì¤‘ê°„     | ì¤‘ê°„     |
| ìœ ì§€ ë³´ìˆ˜ì„±/ìœ ì§€ë¹„           | ë‚®ìŒ     | ì¤‘ê°„     | ë†’ìŒ     |

- **ì¶œë ¥ ê¸°ë°˜ í…ŒìŠ¤íŠ¸**ê°€ ê°€ì¥ ìš°ìˆ˜í•˜ë‚˜, **ìˆœìˆ˜ í•¨ìˆ˜ (pure function)** í˜•íƒœì˜ ì½”ë“œì—ì„œë§Œ ì ìš© ê°€ëŠ¥
- ëŒ€ë¶€ë¶„ì˜ OOP í™˜ê²½ì—ì„  ì¶œë ¥ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›€ â‡’ ì½”ë“œ ë¦¬íŒ©í„°ë§ì´ í•„ìš”
- ìƒíƒœ/í†µì‹  ê¸°ë°˜ í…ŒìŠ¤íŠ¸ ì‚¬ìš© ì‹œë„í•˜ë˜, **ì¶œë ¥ ê¸°ë°˜ìœ¼ë¡œ ì „í™˜ ê°€ëŠ¥ì„±** í•­ìƒ ì—¼ë‘

## ìš”ì•½

| ìš”ì†Œ             | ì¶œë ¥ ê¸°ë°˜            | ìƒíƒœ ê¸°ë°˜               | í†µì‹  ê¸°ë°˜              |
|------------------|---------------------|--------------------------|-------------------------|
| íšŒê·€ ë°©ì§€        | ë™ì¼ (ì°¨ì´ ì—†ìŒ)    | ë™ì¼                     | ë™ì¼ (ë‚¨ìš© ì‹œ ë¬¸ì œ)    |
| ë¹ ë¥¸ í”¼ë“œë°±      | ë™ì¼ (ì‹¤í–‰ ì†ë„ ìœ ì‚¬)| ë™ì¼                     | ì†Œí­ ëŠë¦´ ìˆ˜ ìˆìŒ       |
| ë¦¬íŒ©í„°ë§ ë‚´ì„±    | â˜… ìµœê³               | ë³´í†µ                     | ì·¨ì•½ (ê±°ì§“ ì–‘ì„± â†‘)     |
| ìœ ì§€ ë³´ìˆ˜ì„±      | â˜… ìµœê³               | ì¤‘ê°„ (í—¬í¼ë¡œ ë³´ì™„ ê°€ëŠ¥) | ë‚®ìŒ (ëª© ì„¤ì • ë³µì¡)     |

## ì¶”ì²œ ì˜ˆì œ: ì¬ê³  ì„œë¹„ìŠ¤ (ë„ë©”ì¸ í¬í•¨)

### ë„ë©”ì¸: `InventoryService` â€“ ì¬ê³  ì¶œê³  ì‹œ ì¬ê³  ì¤„ì–´ë“œëŠ” ì¶œë ¥ ê¸°ë°˜ í…ŒìŠ¤íŠ¸

#### As-Is: í†µì‹  ê¸°ë°˜ í…ŒìŠ¤íŠ¸ example
```kotlin
class InventoryServiceTest {

    @MockK
    lateinit var inventoryRepository: InventoryRepository

    lateinit var inventoryService: InventoryService

    @BeforeEach
    fun setup() {
        inventoryService = InventoryService(inventoryRepository)
    }

    @Test
    fun `ìƒí’ˆ ì¶œê³  ì‹œ ì €ì¥ì†Œ í˜¸ì¶œ ì—¬ë¶€ í™•ì¸`() {
        every { inventoryRepository.decreaseStock("item1", 3) } just Runs

        inventoryService.shipItem("item1", 3)

        verify { inventoryRepository.decreaseStock("item1", 3) }
    }
}
```

#### To-Be: ì¶œë ¥ ê¸°ë°˜ìœ¼ë¡œ ìˆœìˆ˜ í•¨ìˆ˜í™” ë° í…ŒìŠ¤íŠ¸ ê°„ì†Œí™”
```kotlin
data class Inventory(val items: MutableMap) {
    fun ship(item: String, quantity: Int): Inventory {
        val currentStock = items.getOrDefault(item, 0)
        require(currentStock >= quantity) { "ì¬ê³  ë¶€ì¡±" }

        val newItems = items.toMutableMap()
        newItems[item] = currentStock - quantity
        return Inventory(newItems)
    }
}

class InventoryTest : StringSpec({
    "ìƒí’ˆ ì¶œê³  ì‹œ ì¬ê³ ê°€ ì •í™•íˆ ì°¨ê°ë˜ì–´ì•¼ í•œë‹¤" {
        val inventory = Inventory(mutableMapOf("item1" to 10))

        val updated = inventory.ship("item1", 3)

        updated.items["item1"] shouldBe 7
    }
})
```

ğŸ“Œ í†µì‹  ê¸°ë°˜ì—ì„œ ì¶œë ¥ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¡°ë¥¼ ë°”ê¾¸ê¸° ìœ„í•´ ë‹¤ìŒì„ ìˆ˜í–‰:
- DB í˜¸ì¶œ ì œê±° â†’ ê°ì²´ ë‚´ë¶€ ìƒíƒœ ë°˜í™˜
- `Inventory`ë¥¼ ë¶ˆë³€ì„± ê¸°ë°˜ êµ¬ì¡°ë¡œ ë³€í™˜

--- 

## ì¸í„°ë„· ì¶”ì²œ ìë£Œ

- [ThoughtWorks - Unit Test Styles Guide](https://www.thoughtworks.com/en-us/insights/blog/unit-test-styles)  
- [Effective Kotlin í…ŒìŠ¤íŠ¸ ì‘ì„± ì „ëµ](https://yozm.wishket.com/magazine/detail/1313/)
- [Kotest ê³µì‹ ë¬¸ì„œ](https://kotest.io)

## íŒŒì¼ëª… ì œì•ˆ
`2501-6.2-ë‹¨ìœ„í…ŒìŠ¤íŠ¸-ìŠ¤íƒ€ì¼ë¹„êµì¶œë ¥ìƒíƒœí†µì‹ ë³„-MD`

## ë‚´ ìƒê°
(ì‚¬ìš©ì ê¸°ì…ë€)

---

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/32004849/09196694-b420-47ea-a20e-6269279eaff3/tdd6-2.pdf